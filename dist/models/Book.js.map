{"version":3,"sources":["../../models/Book.js"],"names":["mongoose","require","BookSchema","Schema","isbn","type","String","unique","required","title","authors","translators","summary","publisher","version","Number","default","min","pubDate","Date","createAt","now","price","location","volume","count","category","cover","pendingTransaction","index","methods","canBorrow","Book","model","e","name","module","exports"],"mappings":";;AAAA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;;AAEA,IAAMC,aAAaF,SAASG,MAAT,CAAgB;AACjCC,QAAM,EAACC,MAAMC,MAAP,EAAeC,QAAQ,IAAvB,EAA6BC,UAAU,IAAvC,EAD2B;AAEjCC,SAAO,EAACJ,MAAMC,MAAP,EAAeE,UAAU,IAAzB,EAF0B;AAGjCE,WAAS,EAACL,MAAM,CAACC,MAAD,CAAP,EAAiBE,UAAU,CAAC,IAAD,EAAO,qBAAP,CAA3B,EAHwB;AAIjCG,eAAa,CAACL,MAAD,CAJoB;AAKjCM,WAASN,MALwB,EAKhB;AACjBO,aAAW,EAACR,MAAMC,MAAP,EAAeE,UAAU,IAAzB,EANsB,EAMU;AAC3CM,WAAS,EAACT,MAAMU,MAAP,EAAeC,SAAS,CAAxB,EAA2BC,KAAK,CAAhC,EAPwB,EAOY;AAC7CC,WAAS,EAACb,MAAMc,IAAP,EARwB,EAQV;AACvBC,YAAU,EAACf,MAAMc,IAAP,EAAaH,SAASG,KAAKE,GAAL,EAAtB,EAAkCb,UAAU,IAA5C,EATuB,EAS4B;AAC7Dc,SAAO,EAACjB,MAAMU,MAAP,EAV0B,EAUV;AACvBQ,YAAUjB,MAXuB,EAWf;AAClBkB,UAAQ,EAACnB,MAAMU,MAAP,EAAeC,SAAS,CAAxB,EAA2BC,KAAK,CAAhC,EAZyB,EAYW;AAC5CQ,SAAO,EAACpB,MAAMU,MAAP,EAAeC,SAAS,CAAxB,EAA2BC,KAAK,CAAhC,EAb0B,EAaU;AAC3CS,YAAUpB,MAduB,EAcf;AAClBqB,SAAOrB,MAf0B;AAgBjCsB,sBAAoB,EAACvB,MAAM,CAACC,MAAD,CAAP,EAAiBU,SAAS,EAA1B;AAhBa,CAAhB,CAAnB;AAkBAd,WAAW2B,KAAX,CAAiB,EAAE,OAAO,MAAT,EAAjB;AACA3B,WAAW4B,OAAX,CAAmBC,SAAnB,GAA+B,YAAY;AACzC,SAAO,KAAKN,KAAL,GAAa,CAApB;AACD,CAFD;AAGA,IAAIO,OAAO,IAAX;AACA,IAAI;AACFA,SAAOhC,SAASiC,KAAT,CAAe,MAAf,EAAuB/B,UAAvB,CAAP;AACD,CAFD,CAEE,OAAOgC,CAAP,EAAU;AACV,MAAIA,EAAEC,IAAF,KAAW,qBAAf,EAAsC;AACpCH,WAAOhC,SAASiC,KAAT,CAAe,MAAf,CAAP;AACD;AACF;;AAEDG,OAAOC,OAAP,GAAiBL,IAAjB","file":"Book.js","sourcesContent":["const mongoose = require('mongoose')\n\nconst BookSchema = mongoose.Schema({\n  isbn: {type: String, unique: true, required: true},\n  title: {type: String, required: true},\n  authors: {type: [String], required: [true, 'At least an author!']},\n  translators: [String],\n  summary: String, //简介\n  publisher: {type: String, required: true}, //出版社\n  version: {type: Number, default: 1, min: 1}, //第几版\n  pubDate: {type: Date}, //出版日期\n  createAt: {type: Date, default: Date.now(), required: true}, //录入日期\n  price: {type: Number}, //价格\n  location: String, //存放位置,格式为1-1，代表第一个书架第一层\n  volume: {type: Number, default: 1, min: 1}, //册数\n  count: {type: Number, default: 1, min: 0}, //数量\n  category: String, //类别\n  cover: String,\n  pendingTransaction: {type: [String], default: []}\n})\nBookSchema.index({ \"$**\": \"text\" })\nBookSchema.methods.canBorrow = function () {\n  return this.count > 0\n}\nlet Book = null\ntry {\n  Book = mongoose.model('Book', BookSchema)\n} catch (e) {\n  if (e.name === 'OverwriteModelError') {\n    Book = mongoose.model('Book')\n  }\n}\n\nmodule.exports = Book\n"]}